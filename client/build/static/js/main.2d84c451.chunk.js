(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{41:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(32),s=n.n(r),a=(n(41),n(26)),i=n(2),u=n(12),l=n.n(u),d=n(19),o=n(1),j=function(e){var t=e.title,n=e.subtitle,c=e.children;return Object(o.jsxs)("main",{className:"bg-base-100 w-full m-0 p-12 flex flex-col items-center rounded shadow-md",children:[Object(o.jsx)("p",{className:"text-4xl font-bold m-4",children:t}),Object(o.jsx)("p",{className:"text-1xl font-bold m-4",children:n}),c]})},h=n(18),b=Object(h.proxy)({users:[],userChats:[],currentUserId:"",currentChatId:""}),m=function(e){var t=e.id,n=e.title,c=e.email,r=e.button,s=e.route;return Object(o.jsxs)("div",{className:"card text-center shadow-md bg-white",children:[Object(o.jsx)("figure",{className:"px-2 pt-2",children:Object(o.jsx)("img",{alt:"Profile",src:"https://picsum.photos/id/1005/400/250",className:"rounded-xl"})}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("h2",{className:"card-title",children:n}),Object(o.jsx)("p",{children:c}),Object(o.jsx)("div",{className:"justify-center card-actions",children:Object(o.jsx)(a.b,{to:"/".concat(s),className:"btn btn-outline border-2 btn-primary btn-block",onClick:function(){return"user"===s?function(e){b.currentUserId=e}(t):function(e){b.currentChatId=e}(t)},children:r})})]})]})},x=function(e){var t=e.children;return Object(o.jsx)("section",{className:"grid gap-3 xl:gap-5 w-full grid-cols-1 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6",children:t})},f=function(){var e=Object(h.useSnapshot)(b),t=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/user");case 2:return e.next=4,e.sent.json();case 4:t=e.sent,b.users=t.data;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){t()}),[]),Object(o.jsx)(j,{title:"WELCOME TO MY MESSAGE APP",subtitle:"USERS:",children:Object(o.jsx)(x,{children:e.users.length&&e.users.map((function(e){return Object(o.jsx)(m,{id:e._id,title:e.name,email:e.email,button:"Select User",route:"user"},e._id)}))})})},p=function(){var e=Object(h.useSnapshot)(b),t=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b.userChats=[],e.next=3,fetch("/api/chat/".concat(t));case 3:return e.next=5,e.sent.json();case 5:n=e.sent,b.userChats=n.data;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var n=e.currentUserId;console.log(n),t(n)}),[e.currentUserId]),Object(o.jsx)(j,{children:Object(o.jsx)(x,{children:e.userChats&&e.userChats.map((function(t){return Object(o.jsx)(m,{id:t._id,button:"Let's chat",route:"chat",title:"Chat con ".concat(t.users[0]._id===e.currentUserId?t.users[1].name:t.users[0].name)},t._id)}))})})},O=n(28),v=n(17),g=n(36),w=Object(g.a)(),N=function(e){var t=e.user,n=e.text;return"left"===e.direction?Object(o.jsx)("div",{className:"card shadow my-3 w-full bg-base-100 md:w-1/2 ",children:Object(o.jsxs)("div",{className:"card-body p-4 ",children:[Object(o.jsx)("h2",{className:"card-title md:text-2xl",children:t}),Object(o.jsx)("p",{children:n})]})}):Object(o.jsx)("div",{className:"card shadow my-3 w-auto bg-primary md:w-1/2 md:self-end",children:Object(o.jsxs)("div",{className:"card-body text-right md:text-left p-4",children:[Object(o.jsx)("h2",{className:"card-title md:text-2xl",children:t}),Object(o.jsx)("p",{children:n})]})})},y=function(e){e.sendText;var t=e.onChange,n=e.onClick,c=e.value;return Object(o.jsx)("div",{className:"form-control mt-8 ",children:Object(o.jsxs)("div",{className:"flex space-x-2 ",children:[Object(o.jsx)("input",{type:"text",value:c,onChange:t,placeholder:"Write something...",className:"w-full input input-primary input-bordered md:text-2xl md:h-20 md:p-10 "}),Object(o.jsx)("button",{className:"btn btn-neutral md:w-64 md:h-20 md:text-2xl",onClick:n,children:"Send"})]})})},C=function(){var e=Object(h.useSnapshot)(b),t=Object(c.useState)(),n=Object(v.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)([]),i=Object(v.a)(a,2),u=i[0],j=i[1],m=Object(c.useState)(""),x=Object(v.a)(m,2),f=x[0],p=x[1],g=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j([]),e.next=3,fetch("/api/chat/".concat(t));case 3:return e.next=5,e.sent.json();case 5:return n=e.sent,s(n.data[0]),e.next=9,fetch("/api/message?chat=".concat(t));case 9:return e.next=11,e.sent.json();case 11:c=e.sent,j(c.data);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={chat:e.currentChatId,user:e.currentUserId,message:f},t.next=3,fetch("/api/message",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(n)});case 3:p("");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){var t=e.currentChatId;console.log(t),g(t),w.on("".concat(t),(function(e){console.log(e),j((function(t){return[].concat(Object(O.a)(t),[e])}))}))}),[e.currentChatId]),Object(c.useEffect)((function(){console.log(u)}),[u]),Object(o.jsx)("main",{className:"w-full min-h-screen flex justify-center items-center md:text-2xl",children:Object(o.jsx)("section",{className:"card shadow rounded-none max-h-full bg-white w-full md:w-4/5 md:rounded-2xl md:my-4",children:Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("h2",{className:"card-title",children:r?r.users[0]._id===e.currentUserId?r.users[1].name:r.users[0].name:null}),u&&u.map((function(t){return Object(o.jsx)(N,{user:t.user.name,text:t.message,direction:t.user._id===e.currentUserId?"right":"left"},t._id)})),Object(o.jsx)(y,{value:f,onChange:function(e){return function(e){p(e.target.value)}(e)},onClick:function(){return C()}})]})})})};n(50);var I=function(){return Object(o.jsx)(a.a,{children:Object(o.jsxs)(i.c,{children:[Object(o.jsx)(i.a,{path:"/",element:Object(o.jsx)(f,{})}),Object(o.jsx)(i.a,{path:"/user",element:Object(o.jsx)(p,{})}),Object(o.jsx)(i.a,{path:"/chat",element:Object(o.jsx)(C,{})})]})})};s.a.render(Object(o.jsx)(I,{}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.2d84c451.chunk.js.map