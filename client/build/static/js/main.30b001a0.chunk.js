(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{42:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(32),s=n.n(r),a=(n(42),n(19)),i=n(2),u=n(12),d=n.n(u),o=n(20),l=n(1),j=function(e){var t=e.title,n=e.subtitle,c=e.children;return Object(l.jsxs)("main",{className:"bg-base-100 w-full m-0 p-12 flex flex-col items-center rounded shadow-md",children:[Object(l.jsx)("p",{className:"text-4xl font-bold m-4",children:t}),Object(l.jsx)("p",{className:"text-1xl font-bold m-4",children:n}),c]})},b=n(18),h=Object(b.proxy)({users:[],userChats:[],currentUserId:"",currentChatId:""}),x=function(e){var t=e.id,n=e.title,c=e.email,r=e.button,s=e.route;return Object(l.jsxs)("div",{className:"card text-center shadow-md bg-white",children:[Object(l.jsx)("figure",{className:"px-2 pt-2",children:Object(l.jsx)("img",{alt:"Profile",src:"https://picsum.photos/id/1005/400/250",className:"rounded-xl"})}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsx)("h2",{className:"card-title",children:n}),Object(l.jsx)("p",{children:c}),Object(l.jsx)("div",{className:"justify-center card-actions",children:Object(l.jsx)(a.b,{to:"/".concat(s),className:"btn btn-outline border-2 btn-primary btn-block",onClick:function(){return"user"===s?function(e){h.currentUserId=e}(t):function(e){h.currentChatId=e}(t)},children:r})})]})]})},f=function(e){var t=e.children;return Object(l.jsx)("section",{className:"grid gap-3 xl:gap-5 w-full grid-cols-1 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6",children:t})},m=n(37),O=function(){var e=Object(i.g)();return Object(l.jsxs)("button",{className:"btn fixed left-12 z-10",onClick:function(){return e(-1)},children:[Object(l.jsx)("div",{className:"text-accent text-xl",children:Object(l.jsx)(m.a,{})}),"Go back"]})},p=function(){var e=Object(b.useSnapshot)(h),t=function(){var e=Object(o.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/user");case 2:return e.next=4,e.sent.json();case 4:t=e.sent,h.users=t.data;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){t()}),[]),Object(l.jsx)(j,{title:"WELCOME TO MY MESSAGE APP",subtitle:"USERS:",children:Object(l.jsx)(f,{children:e.users.length&&e.users.map((function(e){return Object(l.jsx)(x,{id:e._id,title:e.name,email:e.email,button:"Select User",route:"user"},e._id)}))})})},v=function(){var e=Object(b.useSnapshot)(h),t=function(){var e=Object(o.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.userChats=[],e.next=3,fetch("/api/chat/".concat(t));case 3:return e.next=5,e.sent.json();case 5:n=e.sent,h.userChats=n.data;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var n=e.currentUserId;t(n)}),[e.currentUserId]),e.currentUserId?Object(l.jsxs)(j,{children:[Object(l.jsx)(O,{}),Object(l.jsx)(f,{children:e.userChats&&e.userChats.map((function(t){return Object(l.jsx)(x,{id:t._id,button:"Let's chat",route:"chat",title:"Chat con ".concat(t.users[0]._id===e.currentUserId?t.users[1].name:t.users[0].name)},t._id)}))})]}):Object(l.jsx)(i.a,{to:"/"})},g=n(28),w=n(17),y=n(36),N=Object(y.a)(),C=function(e){var t=e.user,n=e.text;return"left"===e.direction?Object(l.jsx)("div",{style:{width:"fit-content"},className:"card shadow my-3 bg-base-100 ",children:Object(l.jsxs)("div",{className:"card-body p-4 ",children:[Object(l.jsx)("h2",{className:"card-title md:text-2xl",children:t}),Object(l.jsx)("p",{children:n})]})}):Object(l.jsx)("div",{style:{width:"fit-content"},className:"card shadow my-3 w-auto bg-primary md:w-1/2 self-end",children:Object(l.jsxs)("div",{className:"card-body text-right md:text-left p-4",children:[Object(l.jsx)("h2",{className:"card-title md:text-2xl",children:t}),Object(l.jsx)("p",{children:n})]})})},I=function(e){var t=e.onChange,n=e.onClick,c=e.value,r=e.onKeyDown;return Object(l.jsx)("div",{className:"form-control mt-8 ",children:Object(l.jsxs)("div",{className:"flex space-x-2 ",children:[Object(l.jsx)("input",{type:"text",value:c,onChange:t,onKeyDown:r,placeholder:"Write something...",className:"w-full input input-primary input-bordered md:text-2xl md:h-20 md:p-10 "}),Object(l.jsx)("button",{className:"btn btn-neutral md:w-64 md:h-20 md:text-2xl",onClick:n,children:"Send"})]})})},k=function(){var e=Object(b.useSnapshot)(h),t=Object(c.useState)(),n=Object(w.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)([]),u=Object(w.a)(a,2),j=u[0],x=u[1],f=Object(c.useState)(""),m=Object(w.a)(f,2),p=m[0],v=m[1],y=Object(c.useRef)(),k=function(){var e=Object(o.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x([]),e.next=3,fetch("/api/chat/".concat(t));case 3:return e.next=5,e.sent.json();case 5:return n=e.sent,s(n.data[0]),e.next=9,fetch("/api/message?chat=".concat(t));case 9:return e.next=11,e.sent.json();case 11:c=e.sent,x(c.data);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var t=Object(o.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p){t.next=5;break}return n={chat:e.currentChatId,user:e.currentUserId,message:p},t.next=4,fetch("/api/message",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(n)});case 4:v("");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){var t=e.currentChatId;k(t),N.on("".concat(t),(function(e){x((function(t){return[].concat(Object(g.a)(t),[e])}))}))}),[e.currentChatId]),Object(c.useEffect)((function(){e.currentUserId&&e.currentChatId&&y.current.scrollIntoView({behavior:"smooth"})}),[j]),e.currentUserId?e.currentChatId?Object(l.jsx)("main",{className:"w-full min-h-screen flex justify-center items-center md:text-2xl",children:Object(l.jsxs)("section",{className:"card shadow rounded-none bg-white w-full md:w-4/5 md:rounded-2xl md:my-4 lg:px-12",children:[Object(l.jsxs)("div",{className:"card-body ",children:[Object(l.jsx)(O,{}),Object(l.jsx)("h2",{className:"card-title",children:r?r.users[0]._id===e.currentUserId?r.users[1].name:r.users[0].name:null}),j&&j.map((function(t){return Object(l.jsx)(C,{user:t.user.name,text:t.message,direction:t.user._id===e.currentUserId?"right":"left"},t._id)})),Object(l.jsx)(I,{value:p,onChange:function(e){return function(e){v(e.target.value)}(e)},onClick:function(){return S()},onKeyDown:function(e){return function(e){13===e.keyCode&&S()}(e)}})]}),Object(l.jsx)("div",{ref:y})]})}):Object(l.jsx)(i.a,{to:"/user"}):Object(l.jsx)(i.a,{to:"/"})};n(51);var S=function(){return Object(l.jsx)(a.a,{children:Object(l.jsxs)(i.d,{children:[Object(l.jsx)(i.b,{path:"/",element:Object(l.jsx)(p,{})}),Object(l.jsx)(i.b,{path:"/user",element:Object(l.jsx)(v,{})}),Object(l.jsx)(i.b,{path:"/chat",element:Object(l.jsx)(k,{})})]})})};s.a.render(Object(l.jsx)(S,{}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.30b001a0.chunk.js.map